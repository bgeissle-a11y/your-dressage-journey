<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health & Soundness Tracker | Your Dressage Journey</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Work+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-primary: #8B7355;
            --color-secondary: #D4A574;
            --color-accent: #C67B5C;
            --color-success: #6B8E5F;
            --color-bg: #FAF8F5;
            --color-bg-secondary: #F5F1EB;
            --color-text: #3A3A3A;
            --color-text-light: #7A7A7A;
            --color-border: #E0D5C7;
            --shadow-soft: 0 2px 12px rgba(139, 115, 85, 0.08);
            --shadow-medium: 0 4px 24px rgba(139, 115, 85, 0.12);

            /* Status colors */
            --color-maintenance: #7A9BBF;
            --color-maintenance-bg: #EEF4FA;
            --color-concern: #C6944A;
            --color-concern-bg: #FBF3E8;
            --color-emergency: #B85C5C;
            --color-emergency-bg: #FAEEEE;

            /* Status pill colors */
            --color-ongoing: #C67B5C;
            --color-ongoing-bg: #FAF0EC;
            --color-resolved: #6B8E5F;
            --color-resolved-bg: #EEF4ED;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Work Sans', sans-serif;
            background: linear-gradient(to bottom, var(--color-bg) 0%, var(--color-bg-secondary) 100%);
            color: var(--color-text);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container { max-width: 820px; margin: 0 auto; }

        /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
        header {
            text-align: center;
            padding: 40px 24px 32px;
            margin-bottom: 32px;
            background: white;
            border-radius: 20px;
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--color-border);
        }

        .header-icon {
            font-size: 2.2em;
            margin-bottom: 10px;
        }

        h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.5em;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 6px;
            letter-spacing: -0.5px;
        }

        .subtitle {
            font-size: 1em;
            color: var(--color-text-light);
            font-weight: 400;
        }

        /* ‚îÄ‚îÄ TABS ‚îÄ‚îÄ */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            background: white;
            border-radius: 14px;
            padding: 6px;
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--color-border);
        }

        .tab-btn {
            flex: 1;
            padding: 10px 16px;
            border: none;
            background: transparent;
            border-radius: 10px;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.88em;
            font-weight: 500;
            color: var(--color-text-light);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .tab-btn.active {
            background: var(--color-primary);
            color: white;
            box-shadow: 0 2px 8px rgba(139, 115, 85, 0.25);
        }

        /* ‚îÄ‚îÄ FORM PANEL ‚îÄ‚îÄ */
        .panel {
            display: none;
        }
        .panel.active { display: block; }

        .form-card {
            background: white;
            border-radius: 20px;
            box-shadow: var(--shadow-medium);
            border: 1px solid var(--color-border);
            overflow: hidden;
        }

        .form-section {
            padding: 28px 32px;
            border-bottom: 1px solid var(--color-border);
        }

        .form-section:last-child { border-bottom: none; }

        .section-label {
            font-size: 0.72em;
            font-weight: 600;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            color: var(--color-secondary);
            margin-bottom: 16px;
        }

        /* ‚îÄ‚îÄ ISSUE TYPE SELECTOR ‚îÄ‚îÄ */
        .issue-type-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .issue-type-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 16px 12px;
            border: 2px solid var(--color-border);
            border-radius: 14px;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Work Sans', sans-serif;
        }

        .issue-type-btn .issue-icon { font-size: 1.6em; }
        .issue-type-btn .issue-name {
            font-size: 0.82em;
            font-weight: 600;
            color: var(--color-text);
        }
        .issue-type-btn .issue-desc {
            font-size: 0.72em;
            color: var(--color-text-light);
            text-align: center;
            line-height: 1.3;
        }

        .issue-type-btn[data-type="maintenance"]:hover,
        .issue-type-btn[data-type="maintenance"].selected {
            border-color: var(--color-maintenance);
            background: var(--color-maintenance-bg);
        }

        .issue-type-btn[data-type="concern"]:hover,
        .issue-type-btn[data-type="concern"].selected {
            border-color: var(--color-concern);
            background: var(--color-concern-bg);
        }

        .issue-type-btn[data-type="emergency"]:hover,
        .issue-type-btn[data-type="emergency"].selected {
            border-color: var(--color-emergency);
            background: var(--color-emergency-bg);
        }

        /* ‚îÄ‚îÄ PROFESSIONAL CHECKBOXES ‚îÄ‚îÄ */
        .pro-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .pro-chip {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            border: 1.5px solid var(--color-border);
            border-radius: 50px;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.85em;
            font-weight: 500;
            color: var(--color-text);
            user-select: none;
        }

        .pro-chip:hover { border-color: var(--color-secondary); }
        .pro-chip.selected {
            border-color: var(--color-primary);
            background: #F5EFE7;
            color: var(--color-primary);
            font-weight: 600;
        }

        .pro-chip input { display: none; }

        /* ‚îÄ‚îÄ FORM FIELDS ‚îÄ‚îÄ */
        .field-group {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .field-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .field {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        label {
            font-size: 0.82em;
            font-weight: 600;
            color: var(--color-text);
            letter-spacing: 0.2px;
        }

        label .optional {
            font-weight: 400;
            color: var(--color-text-light);
            font-size: 0.9em;
        }

        input[type="date"],
        input[type="text"],
        textarea,
        select {
            width: 100%;
            padding: 11px 14px;
            border: 1.5px solid var(--color-border);
            border-radius: 10px;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.9em;
            color: var(--color-text);
            background: var(--color-bg);
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            outline: none;
        }

        input[type="date"]:focus,
        input[type="text"]:focus,
        textarea:focus,
        select:focus {
            border-color: var(--color-secondary);
            box-shadow: 0 0 0 3px rgba(212, 165, 116, 0.15);
            background: white;
        }

        textarea {
            resize: vertical;
            min-height: 90px;
            line-height: 1.5;
        }

        /* ‚îÄ‚îÄ DURATION TOGGLE ‚îÄ‚îÄ */
        .duration-toggle {
            display: flex;
            gap: 10px;
        }

        .duration-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid var(--color-border);
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.85em;
            font-weight: 500;
            color: var(--color-text-light);
            text-align: center;
        }

        .duration-btn.ongoing.selected {
            border-color: var(--color-ongoing);
            background: var(--color-ongoing-bg);
            color: var(--color-ongoing);
            font-weight: 600;
        }

        .duration-btn.resolved.selected {
            border-color: var(--color-resolved);
            background: var(--color-resolved-bg);
            color: var(--color-resolved);
            font-weight: 600;
        }

        .resolved-date-field {
            display: none;
            margin-top: 10px;
        }
        .resolved-date-field.visible { display: block; }

        /* ‚îÄ‚îÄ ACTIONS ‚îÄ‚îÄ */
        .form-actions {
            padding: 24px 32px;
            background: var(--color-bg);
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            border-top: 1px solid var(--color-border);
        }

        .btn-secondary {
            padding: 11px 24px;
            border: 1.5px solid var(--color-border);
            border-radius: 10px;
            background: white;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.88em;
            font-weight: 500;
            color: var(--color-text-light);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-secondary:hover {
            border-color: var(--color-primary);
            color: var(--color-primary);
        }

        .btn-primary {
            padding: 11px 28px;
            border: none;
            border-radius: 10px;
            background: var(--color-primary);
            font-family: 'Work Sans', sans-serif;
            font-size: 0.88em;
            font-weight: 600;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(139, 115, 85, 0.25);
        }

        .btn-primary:hover {
            background: #7A6347;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(139, 115, 85, 0.35);
        }

        /* ‚îÄ‚îÄ LOG PANEL ‚îÄ‚îÄ */
        .log-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
            gap: 12px;
            flex-wrap: wrap;
        }

        .log-filters {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .filter-chip {
            padding: 5px 12px;
            border: 1.5px solid var(--color-border);
            border-radius: 50px;
            background: white;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.78em;
            font-weight: 500;
            color: var(--color-text-light);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .filter-chip.active {
            background: var(--color-primary);
            border-color: var(--color-primary);
            color: white;
        }

        .entries-list {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .entry-card {
            background: white;
            border-radius: 16px;
            border: 1px solid var(--color-border);
            box-shadow: var(--shadow-soft);
            overflow: hidden;
            transition: box-shadow 0.2s ease;
        }

        .entry-card:hover { box-shadow: var(--shadow-medium); }

        .entry-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            gap: 12px;
        }

        .entry-header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .entry-type-badge {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .badge-maintenance { background: var(--color-maintenance); }
        .badge-concern { background: var(--color-concern); }
        .badge-emergency { background: var(--color-emergency); }

        .entry-title {
            font-family: 'Playfair Display', serif;
            font-size: 1em;
            font-weight: 600;
            color: var(--color-text);
        }

        .entry-meta {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-shrink: 0;
        }

        .entry-date {
            font-size: 0.78em;
            color: var(--color-text-light);
        }

        .status-pill {
            font-size: 0.72em;
            font-weight: 600;
            padding: 3px 10px;
            border-radius: 50px;
            letter-spacing: 0.3px;
        }

        .pill-ongoing {
            background: var(--color-ongoing-bg);
            color: var(--color-ongoing);
        }

        .pill-resolved {
            background: var(--color-resolved-bg);
            color: var(--color-resolved);
        }

        .entry-expand-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--color-text-light);
            font-size: 1.2em;
            padding: 2px 4px;
            transition: transform 0.2s ease;
            line-height: 1;
        }

        .entry-body {
            display: none;
            padding: 0 20px 18px;
            border-top: 1px solid var(--color-border);
            margin-top: 0;
        }

        .entry-body.open { display: block; }

        .entry-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px 20px;
            padding-top: 14px;
        }

        .detail-item {}

        .detail-label {
            font-size: 0.72em;
            font-weight: 600;
            letter-spacing: 0.8px;
            text-transform: uppercase;
            color: var(--color-text-light);
            margin-bottom: 3px;
        }

        .detail-value {
            font-size: 0.88em;
            color: var(--color-text);
            line-height: 1.5;
        }

        .detail-full {
            grid-column: 1 / -1;
        }

        .entry-actions {
            display: flex;
            gap: 8px;
            padding-top: 12px;
            margin-top: 12px;
            border-top: 1px solid var(--color-border);
        }

        .entry-btn {
            padding: 6px 14px;
            border-radius: 8px;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.78em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1.5px solid var(--color-border);
            background: white;
            color: var(--color-text-light);
        }

        .entry-btn:hover { border-color: var(--color-primary); color: var(--color-primary); }
        .entry-btn.delete:hover { border-color: var(--color-emergency); color: var(--color-emergency); }
        .entry-btn.resolve:hover { border-color: var(--color-success); color: var(--color-success); }

        /* ‚îÄ‚îÄ EMPTY STATE ‚îÄ‚îÄ */
        .empty-state {
            text-align: center;
            padding: 60px 24px;
            background: white;
            border-radius: 20px;
            border: 1px dashed var(--color-border);
        }

        .empty-state .empty-icon { font-size: 3em; margin-bottom: 12px; opacity: 0.5; }

        .empty-state h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.3em;
            color: var(--color-text-light);
            margin-bottom: 6px;
        }

        .empty-state p {
            font-size: 0.88em;
            color: var(--color-text-light);
        }

        /* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--color-success);
            color: white;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 0.88em;
            font-weight: 500;
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
            transform: translateY(80px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 100;
        }
        .toast.show { transform: translateY(0); opacity: 1; }

        /* ‚îÄ‚îÄ SUMMARY STRIP ‚îÄ‚îÄ */
        .summary-strip {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 24px;
        }

        .summary-card {
            background: white;
            border-radius: 14px;
            padding: 14px 16px;
            border: 1px solid var(--color-border);
            box-shadow: var(--shadow-soft);
            text-align: center;
        }

        .summary-card .s-number {
            font-family: 'Playfair Display', serif;
            font-size: 1.8em;
            font-weight: 700;
            color: var(--color-primary);
            line-height: 1;
        }

        .summary-card .s-label {
            font-size: 0.72em;
            color: var(--color-text-light);
            margin-top: 4px;
        }

        /* ‚îÄ‚îÄ EDIT MODE BANNER ‚îÄ‚îÄ */
        .edit-banner {
            display: none;
            align-items: center;
            justify-content: space-between;
            background: #FBF3E8;
            border: 1.5px solid var(--color-concern);
            border-radius: 12px;
            padding: 10px 16px;
            margin-bottom: 16px;
            font-size: 0.85em;
            color: var(--color-concern);
            font-weight: 500;
        }
        .edit-banner.visible { display: flex; }
        .edit-cancel-btn {
            background: none;
            border: 1.5px solid var(--color-concern);
            border-radius: 8px;
            color: var(--color-concern);
            font-family: 'Work Sans', sans-serif;
            font-size: 0.82em;
            font-weight: 500;
            padding: 4px 12px;
            cursor: pointer;
        }
        .edit-cancel-btn:hover { background: var(--color-concern); color: white; }

        /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
        @media (max-width: 600px) {
            h1 { font-size: 1.9em; }
            .form-section { padding: 20px; }
            .form-actions { padding: 18px 20px; }
            .field-row { grid-template-columns: 1fr; }
            .issue-type-grid { grid-template-columns: 1fr; gap: 8px; }
            .issue-type-btn { flex-direction: row; text-align: left; padding: 12px; }
            .issue-type-btn .issue-desc { text-align: left; }
            .entry-details { grid-template-columns: 1fr; }
            .summary-strip { grid-template-columns: repeat(2, 1fr); }
            .tabs { flex-direction: column; }
        }
    </style>
</head>
<body>
<div class="container">

    <!-- HEADER -->
    <header>
        <div class="header-icon">üê¥</div>
        <h1>Health & Soundness</h1>
        <p class="subtitle">Track your horse's wellbeing ‚Äî from routine maintenance to unexpected concerns</p>
    </header>

    <!-- TABS -->
    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('log-entry')">+ New Entry</button>
        <button class="tab-btn" onclick="switchTab('view-log')">View Log</button>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- PANEL: NEW ENTRY -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="panel-log-entry" class="panel active">

        <!-- Edit mode indicator -->
        <div class="edit-banner" id="edit-banner">
            ‚úèÔ∏è Editing entry ‚Äî make your changes and save
            <button class="edit-cancel-btn" onclick="cancelEdit()">Cancel Edit</button>
        </div>

        <div class="form-card">

            <!-- Horse & Date -->
            <div class="form-section">
                <div class="section-label">Who & When</div>
                <div class="field-row">
                    <div class="field">
                        <label for="horse-name">Horse Name</label>
                        <input type="text" id="horse-name" placeholder="e.g. Ravel, Weltino, Beau">
                    </div>
                    <div class="field">
                        <label for="entry-date">Date of visit or observation</label>
                        <input type="date" id="entry-date">
                    </div>
                </div>
            </div>

            <!-- Issue Type -->
            <div class="form-section">
                <div class="section-label">Type of Issue</div>
                <div class="issue-type-grid">
                    <button class="issue-type-btn" data-type="maintenance" onclick="selectIssueType(this)">
                        <span class="issue-icon">üîß</span>
                        <span class="issue-name">Maintenance</span>
                        <span class="issue-desc">Routine care ‚Äî chiro, massage, farrier, PPE check-in</span>
                    </button>
                    <button class="issue-type-btn" data-type="concern" onclick="selectIssueType(this)">
                        <span class="issue-icon">üëÄ</span>
                        <span class="issue-name">Concern</span>
                        <span class="issue-desc">Something worth monitoring ‚Äî mild lameness, behavior shift, subtle change</span>
                    </button>
                    <button class="issue-type-btn" data-type="emergency" onclick="selectIssueType(this)">
                        <span class="issue-icon">üö®</span>
                        <span class="issue-name">Emergency</span>
                        <span class="issue-desc">Acute or serious ‚Äî colic, injury, significant lameness episode</span>
                    </button>
                </div>
            </div>

            <!-- What's going on -->
            <div class="form-section">
                <div class="section-label">What's Going On</div>
                <div class="field-group">
                    <div class="field">
                        <label for="issue-title">Issue / Condition <span class="optional">(short description)</span></label>
                        <input type="text" id="issue-title" placeholder="e.g. Right hind stiffness, Chiropractic adjustment, Colic episode">
                    </div>
                    <div class="field">
                        <label for="issue-notes">Details <span class="optional">(what you observed or what prompted this)</span></label>
                        <textarea id="issue-notes" placeholder="Describe what you noticed, what changed, or what you wanted to address..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Professional / Seen By -->
            <div class="form-section">
                <div class="section-label">Seen By / Professional Involved</div>
                <div class="pro-grid" id="pro-grid">
                    <label class="pro-chip" onclick="toggleChip(this)">
                        <input type="checkbox" value="Veterinarian"> ü©∫ Veterinarian
                    </label>
                    <label class="pro-chip" onclick="toggleChip(this)">
                        <input type="checkbox" value="Body Worker"> ü§≤ Body Worker
                    </label>
                    <label class="pro-chip" onclick="toggleChip(this)">
                        <input type="checkbox" value="Saddle Fitter"> üêé Saddle Fitter
                    </label>
                    <label class="pro-chip" onclick="toggleChip(this)">
                        <input type="checkbox" value="Farrier"> ü™Ñ Farrier
                    </label>
                    <label class="pro-chip" onclick="toggleChip(this)">
                        <input type="checkbox" value="Trainer"> üë©‚Äçüè´ Trainer
                    </label>
                    <label class="pro-chip" onclick="toggleChip(this)">
                        <input type="checkbox" value="Self-observed"> üëÅÔ∏è Self-observed
                    </label>
                    <label class="pro-chip" onclick="toggleChip(this)">
                        <input type="checkbox" value="Other"> + Other
                    </label>
                </div>
                <div class="field" style="margin-top: 12px;" id="other-pro-field" style="display:none;">
                    <input type="text" id="other-pro-text" placeholder="Who else was involved?">
                </div>
            </div>

            <!-- Results & Next Steps -->
            <div class="form-section">
                <div class="section-label">Findings & Follow-Through</div>
                <div class="field-group">
                    <div class="field">
                        <label for="results">Results / What Happened</label>
                        <textarea id="results" placeholder="What did the professional find? What treatment or work was done? What was the outcome?"></textarea>
                    </div>
                    <div class="field">
                        <label for="next-steps">Next Steps <span class="optional">(optional)</span></label>
                        <textarea id="next-steps" placeholder="Follow-up appointments, exercises, restrictions, things to watch for..." style="min-height: 70px;"></textarea>
                    </div>
                </div>
            </div>

            <!-- Duration / Status -->
            <div class="form-section">
                <div class="section-label">Status</div>
                <div class="field">
                    <label>Is this issue ongoing or resolved?</label>
                    <div class="duration-toggle">
                        <button class="duration-btn ongoing" data-status="ongoing" onclick="selectDuration(this)">
                            üîÑ Ongoing
                        </button>
                        <button class="duration-btn resolved" data-status="resolved" onclick="selectDuration(this)">
                            ‚úÖ Resolved
                        </button>
                    </div>
                    <div class="resolved-date-field" id="resolved-date-wrap">
                        <label for="resolved-date" style="margin-top: 10px; display: block;">Date resolved <span class="optional">(if known)</span></label>
                        <input type="date" id="resolved-date" style="margin-top: 6px;">
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="form-actions">
                <button class="btn-secondary" onclick="clearForm()">Clear</button>
                <button class="btn-primary" onclick="saveEntry()">Save Entry</button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- PANEL: VIEW LOG -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="panel-view-log" class="panel">

        <!-- Summary Strip -->
        <div class="summary-strip" id="summary-strip">
            <div class="summary-card">
                <div class="s-number" id="count-total">0</div>
                <div class="s-label">Total Entries</div>
            </div>
            <div class="summary-card">
                <div class="s-number" id="count-ongoing" style="color: var(--color-ongoing);">0</div>
                <div class="s-label">Ongoing</div>
            </div>
            <div class="summary-card">
                <div class="s-number" id="count-resolved" style="color: var(--color-resolved);">0</div>
                <div class="s-label">Resolved</div>
            </div>
            <div class="summary-card">
                <div class="s-number" id="count-emergency" style="color: var(--color-emergency);">0</div>
                <div class="s-label">Emergencies</div>
            </div>
        </div>

        <!-- Filters -->
        <div class="log-header">
            <div class="log-filters" id="filter-group">
                <button class="filter-chip active" data-filter="all" onclick="setFilter(this, 'all')">All</button>
                <button class="filter-chip" data-filter="maintenance" onclick="setFilter(this, 'maintenance')">üîß Maintenance</button>
                <button class="filter-chip" data-filter="concern" onclick="setFilter(this, 'concern')">üëÄ Concern</button>
                <button class="filter-chip" data-filter="emergency" onclick="setFilter(this, 'emergency')">üö® Emergency</button>
                <button class="filter-chip" data-filter="ongoing" onclick="setFilter(this, 'ongoing')">üîÑ Ongoing</button>
                <button class="filter-chip" data-filter="resolved" onclick="setFilter(this, 'resolved')">‚úÖ Resolved</button>
            </div>
        </div>

        <div class="entries-list" id="entries-list">
            <!-- populated by JS -->
        </div>
    </div>

</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script>
    // ‚îÄ‚îÄ STATE ‚îÄ‚îÄ
    let entries = JSON.parse(localStorage.getItem('ydj-health-entries') || '[]');
    let selectedIssueType = null;
    let selectedDuration = null;
    let activeFilter = 'all';
    let editingId = null;

    // ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
    document.addEventListener('DOMContentLoaded', () => {
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('entry-date').value = today;
        renderEntries();
        updateSummary();
    });

    // ‚îÄ‚îÄ TABS ‚îÄ‚îÄ
    function switchTab(tab) {
        switchTabByName(tab);
    }

    // ‚îÄ‚îÄ SELECTORS ‚îÄ‚îÄ
    function selectIssueType(btn) {
        document.querySelectorAll('.issue-type-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        selectedIssueType = btn.dataset.type;
    }

    function selectDuration(btn) {
        document.querySelectorAll('.duration-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        selectedDuration = btn.dataset.status;
        const wrap = document.getElementById('resolved-date-wrap');
        wrap.classList.toggle('visible', selectedDuration === 'resolved');
    }

    function toggleChip(label) {
        label.classList.toggle('selected');
        // Show "Other" text field if Other chip is selected
        const otherField = document.getElementById('other-pro-field');
        const anyOther = [...document.querySelectorAll('.pro-chip')].find(
            c => c.querySelector('input').value === 'Other' && c.classList.contains('selected')
        );
        if (otherField) otherField.style.display = anyOther ? 'block' : 'none';
    }

    // ‚îÄ‚îÄ SAVE ‚îÄ‚îÄ
    function saveEntry() {
        const date = document.getElementById('entry-date').value;
        const title = document.getElementById('issue-title').value.trim();
        const horseName = document.getElementById('horse-name').value.trim();

        if (!horseName) { showToast('Please enter the horse name.', 'warn'); return; }
        if (!date) { showToast('Please add a date.', 'warn'); return; }
        if (!title) { showToast('Please describe the issue.', 'warn'); return; }
        if (!selectedIssueType) { showToast('Please select an issue type.', 'warn'); return; }
        if (!selectedDuration) { showToast('Please set the status (Ongoing or Resolved).', 'warn'); return; }

        const professionals = [...document.querySelectorAll('.pro-chip.selected')]
            .map(c => c.querySelector('input').value);

        if (professionals.includes('Other')) {
            const otherText = document.getElementById('other-pro-text').value.trim();
            if (otherText) { professionals[professionals.indexOf('Other')] = otherText; }
        }

        const entryData = {
            date,
            horseName,
            issueType: selectedIssueType,
            title,
            notes: document.getElementById('issue-notes').value.trim(),
            professionals,
            results: document.getElementById('results').value.trim(),
            nextSteps: document.getElementById('next-steps').value.trim(),
            status: selectedDuration,
            resolvedDate: selectedDuration === 'resolved'
                ? document.getElementById('resolved-date').value : null,
        };

        if (editingId !== null) {
            // Update existing entry
            const idx = entries.findIndex(e => e.id === editingId);
            if (idx > -1) {
                entries[idx] = { ...entries[idx], ...entryData };
                localStorage.setItem('ydj-health-entries', JSON.stringify(entries));
                showToast('Entry updated ‚úì');
                cancelEdit();
                switchTabByName('view-log');
                renderEntries();
                updateSummary();
            }
        } else {
            // New entry
            entries.unshift({ id: Date.now(), ...entryData });
            localStorage.setItem('ydj-health-entries', JSON.stringify(entries));
            showToast('Entry saved ‚úì');
            clearForm();
        }
    }

    // ‚îÄ‚îÄ CLEAR ‚îÄ‚îÄ
    function clearForm() {
        document.getElementById('entry-date').value = new Date().toISOString().split('T')[0];
        document.getElementById('horse-name').value = '';
        document.getElementById('issue-title').value = '';
        document.getElementById('issue-notes').value = '';
        document.getElementById('results').value = '';
        document.getElementById('next-steps').value = '';
        document.getElementById('resolved-date').value = '';
        document.getElementById('other-pro-text').value = '';
        document.getElementById('other-pro-field').style.display = 'none';
        document.querySelectorAll('.issue-type-btn').forEach(b => b.classList.remove('selected'));
        document.querySelectorAll('.duration-btn').forEach(b => b.classList.remove('selected'));
        document.querySelectorAll('.pro-chip').forEach(c => c.classList.remove('selected'));
        document.getElementById('resolved-date-wrap').classList.remove('visible');
        selectedIssueType = null;
        selectedDuration = null;
        editingId = null;
        document.getElementById('edit-banner').classList.remove('visible');
    }

    // ‚îÄ‚îÄ RENDER LOG ‚îÄ‚îÄ
    function renderEntries() {
        const list = document.getElementById('entries-list');
        let filtered = entries;

        if (activeFilter !== 'all') {
            if (['ongoing', 'resolved'].includes(activeFilter)) {
                filtered = entries.filter(e => e.status === activeFilter);
            } else {
                filtered = entries.filter(e => e.issueType === activeFilter);
            }
        }

        if (filtered.length === 0) {
            list.innerHTML = `
                <div class="empty-state">
                    <div class="empty-icon">üê¥</div>
                    <h3>${activeFilter === 'all' ? 'No entries yet' : 'No entries match this filter'}</h3>
                    <p>${activeFilter === 'all' ? 'Start tracking your horse\'s health and soundness.' : 'Try a different filter.'}</p>
                </div>`;
            return;
        }

        list.innerHTML = filtered.map(entry => `
            <div class="entry-card" id="card-${entry.id}">
                <div class="entry-header">
                    <div class="entry-header-left">
                        <div class="entry-type-badge badge-${entry.issueType}"></div>
                        <div>
                            <div class="entry-title">${entry.title}</div>
                            <div class="entry-date">${entry.horseName ? `<strong>${entry.horseName}</strong> &middot; ` : ''}${formatDate(entry.date)} &middot; ${capitalize(entry.issueType)}</div>
                        </div>
                    </div>
                    <div class="entry-meta">
                        <span class="status-pill pill-${entry.status}">${entry.status === 'ongoing' ? 'üîÑ Ongoing' : '‚úÖ Resolved'}</span>
                        <button class="entry-expand-btn" onclick="toggleEntry(${entry.id})" id="expand-${entry.id}">‚ñæ</button>
                    </div>
                </div>
                <div class="entry-body" id="body-${entry.id}">
                    <div class="entry-details">
                        ${entry.horseName ? `
                        <div class="detail-item">
                            <div class="detail-label">Horse</div>
                            <div class="detail-value">${entry.horseName}</div>
                        </div>` : ''}
                        ${entry.professionals?.length ? `
                        <div class="detail-item">
                            <div class="detail-label">Seen By</div>
                            <div class="detail-value">${entry.professionals.join(', ')}</div>
                        </div>` : ''}
                        ${entry.resolvedDate ? `
                        <div class="detail-item">
                            <div class="detail-label">Resolved On</div>
                            <div class="detail-value">${formatDate(entry.resolvedDate)}</div>
                        </div>` : ''}
                        ${entry.notes ? `
                        <div class="detail-item detail-full">
                            <div class="detail-label">Details / Observation</div>
                            <div class="detail-value">${entry.notes}</div>
                        </div>` : ''}
                        ${entry.results ? `
                        <div class="detail-item detail-full">
                            <div class="detail-label">Results / What Happened</div>
                            <div class="detail-value">${entry.results}</div>
                        </div>` : ''}
                        ${entry.nextSteps ? `
                        <div class="detail-item detail-full">
                            <div class="detail-label">Next Steps</div>
                            <div class="detail-value">${entry.nextSteps}</div>
                        </div>` : ''}
                    </div>
                    <div class="entry-actions">
                        <button class="entry-btn" onclick="editEntry(${entry.id})">‚úèÔ∏è Edit</button>
                        ${entry.status === 'ongoing' ? `<button class="entry-btn resolve" onclick="markResolved(${entry.id})">Mark Resolved</button>` : ''}
                        <button class="entry-btn delete" onclick="deleteEntry(${entry.id})">Delete</button>
                    </div>
                </div>
            </div>
        `).join('');
    }

    // ‚îÄ‚îÄ TOGGLE ENTRY DETAIL ‚îÄ‚îÄ
    function toggleEntry(id) {
        const body = document.getElementById('body-' + id);
        const btn = document.getElementById('expand-' + id);
        body.classList.toggle('open');
        btn.textContent = body.classList.contains('open') ? '‚ñ¥' : '‚ñæ';
    }

    // ‚îÄ‚îÄ EDIT ENTRY ‚îÄ‚îÄ
    function editEntry(id) {
        const entry = entries.find(e => e.id === id);
        if (!entry) return;

        editingId = id;

        // Switch to entry form tab
        switchTabByName('log-entry');

        // Populate fields
        document.getElementById('entry-date').value = entry.date || '';
        document.getElementById('horse-name').value = entry.horseName || '';
        document.getElementById('issue-title').value = entry.title || '';
        document.getElementById('issue-notes').value = entry.notes || '';
        document.getElementById('results').value = entry.results || '';
        document.getElementById('next-steps').value = entry.nextSteps || '';
        document.getElementById('resolved-date').value = entry.resolvedDate || '';

        // Issue type
        document.querySelectorAll('.issue-type-btn').forEach(b => {
            b.classList.toggle('selected', b.dataset.type === entry.issueType);
        });
        selectedIssueType = entry.issueType;

        // Status
        document.querySelectorAll('.duration-btn').forEach(b => {
            b.classList.toggle('selected', b.dataset.status === entry.status);
        });
        selectedDuration = entry.status;
        document.getElementById('resolved-date-wrap').classList.toggle('visible', entry.status === 'resolved');

        // Professionals
        document.querySelectorAll('.pro-chip').forEach(chip => {
            const val = chip.querySelector('input').value;
            const isSelected = (entry.professionals || []).includes(val);
            chip.classList.toggle('selected', isSelected);
        });

        // Show edit banner
        document.getElementById('edit-banner').classList.add('visible');

        // Scroll to top of form
        document.getElementById('panel-log-entry').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function cancelEdit() {
        editingId = null;
        document.getElementById('edit-banner').classList.remove('visible');
        clearForm();
    }

    // ‚îÄ‚îÄ SWITCH TAB PROGRAMMATICALLY ‚îÄ‚îÄ
    function switchTabByName(tab) {
        document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('panel-' + tab).classList.add('active');
        const idx = tab === 'log-entry' ? 0 : 1;
        document.querySelectorAll('.tab-btn')[idx].classList.add('active');
        if (tab === 'view-log') { renderEntries(); updateSummary(); }
    }

    // ‚îÄ‚îÄ MARK RESOLVED ‚îÄ‚îÄ
    function markResolved(id) {
        const idx = entries.findIndex(e => e.id === id);
        if (idx > -1) {
            entries[idx].status = 'resolved';
            entries[idx].resolvedDate = new Date().toISOString().split('T')[0];
            localStorage.setItem('ydj-health-entries', JSON.stringify(entries));
            renderEntries();
            updateSummary();
            showToast('Marked as resolved ‚úì');
        }
    }

    // ‚îÄ‚îÄ DELETE ‚îÄ‚îÄ
    function deleteEntry(id) {
        if (!confirm('Delete this entry? This cannot be undone.')) return;
        entries = entries.filter(e => e.id !== id);
        localStorage.setItem('ydj-health-entries', JSON.stringify(entries));
        renderEntries();
        updateSummary();
        showToast('Entry deleted');
    }

    // ‚îÄ‚îÄ SUMMARY ‚îÄ‚îÄ
    function updateSummary() {
        document.getElementById('count-total').textContent = entries.length;
        document.getElementById('count-ongoing').textContent = entries.filter(e => e.status === 'ongoing').length;
        document.getElementById('count-resolved').textContent = entries.filter(e => e.status === 'resolved').length;
        document.getElementById('count-emergency').textContent = entries.filter(e => e.issueType === 'emergency').length;
    }

    // ‚îÄ‚îÄ FILTER ‚îÄ‚îÄ
    function setFilter(btn, filter) {
        document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        activeFilter = filter;
        renderEntries();
    }

    // ‚îÄ‚îÄ HELPERS ‚îÄ‚îÄ
    function formatDate(dateStr) {
        if (!dateStr) return '';
        const [y, m, d] = dateStr.split('-');
        const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
        return `${months[parseInt(m)-1]} ${parseInt(d)}, ${y}`;
    }

    function capitalize(str) {
        return str ? str.charAt(0).toUpperCase() + str.slice(1) : '';
    }

    function showToast(msg, type) {
        const t = document.getElementById('toast');
        t.textContent = msg;
        t.style.background = type === 'warn' ? 'var(--color-concern)' : 'var(--color-success)';
        t.classList.add('show');
        setTimeout(() => t.classList.remove('show'), 2800);
    }
</script>
</body>
</html>
