<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>First Glimpse | Your Dressage Journey</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400;1,600&family=Work+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-primary: #8B7355;
            --color-secondary: #D4A574;
            --color-accent: #C67B5C;
            --color-success: #6B8E5F;
            --color-bg: #FAF8F5;
            --color-bg-secondary: #F5F1EB;
            --color-text: #3A3A3A;
            --color-text-light: #7A7A7A;
            --color-border: #E0D5C7;
            --shadow-soft: 0 2px 12px rgba(139, 115, 85, 0.08);
            --shadow-medium: 0 4px 24px rgba(139, 115, 85, 0.12);
            --shadow-large: 0 8px 40px rgba(139, 115, 85, 0.16);

            /* Category colors */
            --cat-milestone: #4A7DC4;
            --cat-validation: #5B9E6B;
            --cat-aha: #C9A227;
            --cat-obstacle: #C45252;
            --cat-connection: #8B5EA0;
            --cat-body: #7BA7BC;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Work Sans', sans-serif;
            background: var(--color-bg);
            color: var(--color-text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* â”€â”€â”€ TOP BAR â”€â”€â”€ */
        .top-bar {
            width: 100%;
            background: white;
            border-bottom: 1px solid var(--color-border);
            padding: 16px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-soft);
        }

        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 1.1em;
            color: var(--color-primary);
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        .logo span {
            font-weight: 400;
            color: var(--color-text-light);
            font-size: 0.85em;
            display: block;
            font-family: 'Work Sans', sans-serif;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .progress-area {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 6px;
            min-width: 140px;
        }

        .progress-label {
            font-size: 0.72em;
            color: var(--color-text-light);
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }

        .progress-track {
            width: 140px;
            height: 4px;
            background: var(--color-border);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--color-primary), var(--color-secondary));
            border-radius: 2px;
            transition: width 0.4s ease;
        }

        /* â”€â”€â”€ MAIN WRAPPER â”€â”€â”€ */
        .main {
            width: 100%;
            max-width: 680px;
            padding: 40px 20px 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* â”€â”€â”€ WELCOME SCREEN â”€â”€â”€ */
        .welcome-screen {
            text-align: center;
            padding: 20px 0;
        }

        .welcome-badge {
            display: inline-block;
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            color: var(--color-primary);
            font-size: 0.75em;
            font-weight: 500;
            letter-spacing: 1.2px;
            text-transform: uppercase;
            padding: 6px 16px;
            border-radius: 20px;
            margin-bottom: 24px;
        }

        .welcome-screen h1 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(2em, 5vw, 3em);
            color: var(--color-primary);
            line-height: 1.2;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .welcome-screen h1 em {
            font-style: italic;
            color: var(--color-accent);
        }

        .welcome-screen p {
            color: var(--color-text-light);
            font-size: 1.05em;
            line-height: 1.7;
            max-width: 520px;
            margin: 0 auto 32px;
        }

        .welcome-meta {
            display: flex;
            gap: 24px;
            justify-content: center;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .welcome-meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--color-text-light);
            font-size: 0.88em;
        }

        .welcome-meta-item .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--color-secondary);
            flex-shrink: 0;
        }

        .btn-start {
            background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
            color: white;
            border: none;
            padding: 16px 48px;
            border-radius: 50px;
            font-family: 'Work Sans', sans-serif;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            letter-spacing: 0.3px;
            box-shadow: 0 4px 20px rgba(139, 115, 85, 0.3);
            transition: transform 0.15s, box-shadow 0.15s;
        }

        .btn-start:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 28px rgba(139, 115, 85, 0.4);
        }

        .btn-start:active { transform: translateY(0); }

        .welcome-disclaimer {
            margin-top: 20px;
            font-size: 0.78em;
            color: var(--color-text-light);
        }

        /* â”€â”€â”€ QUESTION SCREEN â”€â”€â”€ */
        .question-screen {
            width: 100%;
            display: none;
            animation: fadeSlideIn 0.35s ease forwards;
        }

        @keyframes fadeSlideIn {
            from { opacity: 0; transform: translateY(16px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .question-card {
            background: white;
            border-radius: 20px;
            padding: 48px 48px 40px;
            box-shadow: var(--shadow-medium);
            border: 1px solid var(--color-border);
            width: 100%;
        }

        @media (max-width: 600px) {
            .question-card { padding: 32px 24px 28px; }
        }

        .q-step {
            font-size: 0.72em;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            color: var(--color-text-light);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .q-text {
            font-family: 'Playfair Display', serif;
            font-size: clamp(1.3em, 3.5vw, 1.65em);
            color: var(--color-text);
            line-height: 1.4;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .q-sub {
            font-size: 0.88em;
            color: var(--color-text-light);
            line-height: 1.5;
            margin-bottom: 28px;
            font-style: italic;
        }

        textarea {
            width: 100%;
            min-height: 130px;
            padding: 16px 18px;
            border: 1.5px solid var(--color-border);
            border-radius: 12px;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.97em;
            color: var(--color-text);
            line-height: 1.6;
            background: var(--color-bg);
            resize: vertical;
            transition: border-color 0.2s, box-shadow 0.2s;
            outline: none;
        }

        textarea:focus {
            border-color: var(--color-secondary);
            box-shadow: 0 0 0 3px rgba(212, 165, 116, 0.12);
            background: white;
        }

        textarea::placeholder { color: #B0A898; }

        input[type="text"] {
            width: 100%;
            padding: 14px 18px;
            border: 1.5px solid var(--color-border);
            border-radius: 12px;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.97em;
            color: var(--color-text);
            background: var(--color-bg);
            transition: border-color 0.2s, box-shadow 0.2s;
            outline: none;
        }

        input[type="text"]:focus {
            border-color: var(--color-secondary);
            box-shadow: 0 0 0 3px rgba(212, 165, 116, 0.12);
            background: white;
        }

        input[type="text"]::placeholder { color: #B0A898; }

        select {
            width: 100%;
            padding: 14px 18px;
            border: 1.5px solid var(--color-border);
            border-radius: 12px;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.97em;
            color: var(--color-text);
            background: var(--color-bg);
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%238B7355' stroke-width='1.5' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 18px center;
            cursor: pointer;
            outline: none;
            transition: border-color 0.2s;
        }

        select:focus { border-color: var(--color-secondary); }

        .optional-badge {
            display: inline-block;
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            color: var(--color-text-light);
            font-size: 0.7em;
            padding: 3px 10px;
            border-radius: 10px;
            margin-left: 8px;
            vertical-align: middle;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }

        /* â”€â”€â”€ NAV BUTTONS â”€â”€â”€ */
        .q-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 28px;
            gap: 12px;
        }

        .btn-back {
            background: none;
            border: 1.5px solid var(--color-border);
            color: var(--color-text-light);
            padding: 12px 24px;
            border-radius: 50px;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.9em;
            cursor: pointer;
            transition: border-color 0.2s, color 0.2s;
        }

        .btn-back:hover { border-color: var(--color-primary); color: var(--color-primary); }

        .btn-next {
            background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
            color: white;
            border: none;
            padding: 13px 36px;
            border-radius: 50px;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.95em;
            font-weight: 500;
            cursor: pointer;
            letter-spacing: 0.3px;
            box-shadow: 0 3px 14px rgba(139, 115, 85, 0.28);
            transition: transform 0.15s, box-shadow 0.15s;
            flex-shrink: 0;
        }

        .btn-next:hover { transform: translateY(-1px); box-shadow: 0 5px 20px rgba(139, 115, 85, 0.36); }
        .btn-next:active { transform: translateY(0); }

        .btn-next:disabled {
            opacity: 0.45;
            cursor: not-allowed;
            transform: none;
        }

        .skip-link {
            text-align: center;
            margin-top: 14px;
        }

        .skip-link a {
            font-size: 0.82em;
            color: var(--color-text-light);
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: border-color 0.2s, color 0.2s;
        }

        .skip-link a:hover { color: var(--color-primary); border-color: var(--color-primary); }

        /* â”€â”€â”€ LOADING SCREEN â”€â”€â”€ */
        .loading-screen {
            display: none;
            text-align: center;
            padding: 60px 20px;
        }

        .loading-horse {
            font-size: 3.5em;
            margin-bottom: 24px;
            animation: float 2s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        .loading-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.6em;
            color: var(--color-primary);
            margin-bottom: 12px;
        }

        .loading-sub {
            color: var(--color-text-light);
            font-size: 0.95em;
            line-height: 1.6;
            max-width: 400px;
            margin: 0 auto 32px;
        }

        .loading-dots {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        .loading-dots span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--color-secondary);
            animation: pulse 1.2s ease-in-out infinite;
        }

        .loading-dots span:nth-child(2) { animation-delay: 0.2s; }
        .loading-dots span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes pulse {
            0%, 80%, 100% { transform: scale(0.7); opacity: 0.4; }
            40% { transform: scale(1); opacity: 1; }
        }

        .loading-messages {
            margin-top: 28px;
            min-height: 24px;
        }

        .loading-msg {
            font-size: 0.85em;
            color: var(--color-text-light);
            font-style: italic;
            opacity: 0;
            transition: opacity 0.5s;
        }

        .loading-msg.visible { opacity: 1; }

        /* â”€â”€â”€ RESULT SCREEN â”€â”€â”€ */
        .result-screen {
            display: none;
            width: 100%;
            animation: fadeSlideIn 0.5s ease forwards;
        }

        .result-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .result-header h2 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(1.6em, 4vw, 2.2em);
            color: var(--color-primary);
            margin-bottom: 8px;
        }

        .result-header p {
            color: var(--color-text-light);
            font-size: 0.92em;
        }

        .voice-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: white;
            border: 1px solid var(--color-border);
            border-radius: 20px;
            padding: 6px 16px 6px 10px;
            margin-bottom: 24px;
            box-shadow: var(--shadow-soft);
        }

        .voice-badge .icon { font-size: 1.1em; }

        .voice-badge .label {
            font-size: 0.78em;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: var(--color-text-light);
        }

        .voice-badge .name {
            font-family: 'Playfair Display', serif;
            font-size: 0.92em;
            color: var(--color-primary);
            font-weight: 600;
        }

        .result-card {
            background: white;
            border-radius: 20px;
            padding: 40px 44px;
            box-shadow: var(--shadow-large);
            border: 1px solid var(--color-border);
            margin-bottom: 24px;
        }

        @media (max-width: 600px) {
            .result-card { padding: 28px 22px; }
        }

        .result-insight {
            font-size: 1.05em;
            line-height: 1.8;
            color: var(--color-text);
            font-family: 'Work Sans', sans-serif;
            margin-bottom: 32px;
        }

        .result-divider {
            height: 1px;
            background: var(--color-border);
            margin-bottom: 28px;
        }

        .actionable-label {
            font-size: 0.7em;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--color-secondary);
            font-weight: 600;
            margin-bottom: 12px;
        }

        .actionable-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.2em;
            color: var(--color-primary);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .actionable-text {
            font-size: 0.97em;
            line-height: 1.7;
            color: var(--color-text);
        }

        .result-cta-card {
            background: linear-gradient(135deg, #3A2E22 0%, #5C4033 60%, #8B7355 100%);
            border-radius: 20px;
            padding: 40px 44px;
            text-align: center;
            color: white;
            margin-bottom: 16px;
        }

        @media (max-width: 600px) {
            .result-cta-card { padding: 28px 22px; }
        }

        .result-cta-card h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.5em;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .result-cta-card p {
            font-size: 0.92em;
            line-height: 1.65;
            opacity: 0.85;
            max-width: 420px;
            margin: 0 auto 28px;
        }

        .btn-cta {
            background: white;
            color: var(--color-primary);
            border: none;
            padding: 14px 40px;
            border-radius: 50px;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            letter-spacing: 0.3px;
            transition: transform 0.15s, box-shadow 0.15s, opacity 0.15s;
            box-shadow: 0 3px 16px rgba(0,0,0,0.2);
            display: inline-block;
            text-decoration: none;
            flex-shrink: 0;
        }

        .btn-cta:hover { transform: translateY(-2px); box-shadow: 0 5px 24px rgba(0,0,0,0.25); }
        .btn-cta:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }

        /* â”€â”€â”€ CTA EMAIL CAPTURE â”€â”€â”€ */
        .cta-input-row {
            display: flex;
            gap: 10px;
            max-width: 460px;
            margin: 0 auto;
        }

        @media (max-width: 500px) {
            .cta-input-row {
                flex-direction: column;
                align-items: stretch;
            }
            .cta-input-row .btn-cta { padding: 14px 24px; }
        }

        .cta-email-input {
            flex: 1;
            padding: 14px 18px;
            border: none;
            border-radius: 50px;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.95em;
            color: var(--color-text);
            outline: none;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }

        .cta-email-input::placeholder { color: #B0A898; }

        .cta-error {
            color: #F5C6BC;
            font-size: 0.82em;
            margin-top: 10px;
            min-height: 1.2em;
        }

        .cta-success-check {
            font-size: 2.5em;
            margin-bottom: 12px;
        }

        .cta-thanks {
            font-size: 1em;
            opacity: 0.9;
            margin: 0;
        }

        .result-restart {
            text-align: center;
            margin-top: 8px;
        }

        .result-restart a {
            font-size: 0.82em;
            color: var(--color-text-light);
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: all 0.2s;
        }

        .result-restart a:hover { color: var(--color-primary); border-color: var(--color-primary); }

        /* â”€â”€â”€ ERROR â”€â”€â”€ */
        .error-card {
            background: #FEF3F0;
            border: 1px solid #F5C6BC;
            border-radius: 12px;
            padding: 20px 24px;
            color: #8B3A2A;
            font-size: 0.9em;
            line-height: 1.6;
            margin-top: 16px;
            display: none;
        }

        /* â”€â”€â”€ DECORATIVE CATEGORY STRIPE â”€â”€â”€ */
        .category-stripe {
            display: flex;
            gap: 4px;
            justify-content: center;
            margin: 32px 0 0;
        }

        .category-stripe .stripe {
            height: 3px;
            width: 36px;
            border-radius: 2px;
        }

    </style>
</head>
<body>

<!-- TOP BAR -->
<div class="top-bar">
    <div class="logo">
        Your Dressage Journey
        <span>First Glimpse</span>
    </div>
    <div class="progress-area">
        <div class="progress-label" id="progressLabel">Welcome</div>
        <div class="progress-track">
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>
    </div>
</div>

<!-- MAIN -->
<div class="main">

    <!-- WELCOME SCREEN -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-badge">A Gift for Riders</div>
        <h1>Your journey begins<br>with a <em>single glimpse</em></h1>
        <p>Answer 13 short questions about yourself, your horse, and your riding â€” and receive a personalized insight crafted just for you. No login required. No commitment. Just a taste of what's possible when your riding story meets thoughtful analysis.</p>

        <div class="welcome-meta">
            <div class="welcome-meta-item"><div class="dot"></div>About 5â€“7 minutes</div>
            <div class="welcome-meta-item"><div class="dot"></div>13 questions + 1 optional</div>
            <div class="welcome-meta-item"><div class="dot"></div>One personalized insight</div>
        </div>

        <button class="btn-start" onclick="startJourney()">Begin My First Glimpse â†’</button>

        <div class="welcome-disclaimer">Your responses are used only to generate your insight and are not stored.</div>

        <div class="category-stripe">
            <div class="stripe" style="background: var(--cat-milestone)"></div>
            <div class="stripe" style="background: var(--cat-validation)"></div>
            <div class="stripe" style="background: var(--cat-aha)"></div>
            <div class="stripe" style="background: var(--cat-obstacle)"></div>
            <div class="stripe" style="background: var(--cat-connection)"></div>
            <div class="stripe" style="background: var(--cat-body)"></div>
        </div>
    </div>

    <!-- QUESTIONS -->
    <div id="questionContainer" style="width: 100%"></div>

    <!-- LOADING -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-horse">ğŸ´</div>
        <h2 class="loading-title">Reading your storyâ€¦</h2>
        <p class="loading-sub">Your responses are being woven into something personal. This takes just a moment.</p>
        <div class="loading-dots">
            <span></span><span></span><span></span>
        </div>
        <div class="loading-messages">
            <p class="loading-msg" id="loadingMsg">Listening to what you've sharedâ€¦</p>
        </div>
    </div>

    <!-- RESULT -->
    <div class="result-screen" id="resultScreen">
        <div class="result-header">
            <h2 id="resultGreeting">Your First Glimpse</h2>
            <p>A personalized insight, crafted from what you shared</p>
        </div>
        <div style="text-align: center">
            <div class="voice-badge" id="voiceBadge">
                <span class="icon">ğŸ¯</span>
                <span class="label">Your coach today</span>
                <span class="name" id="voiceName">The Classical Master</span>
            </div>
        </div>
        <div class="result-card">
            <div class="result-insight" id="resultInsight"></div>
            <div class="result-divider"></div>
            <div class="actionable-label">Your First Step</div>
            <div class="actionable-title" id="actionableTitle"></div>
            <div class="actionable-text" id="actionableText"></div>
        </div>
        <div class="error-card" id="errorCard"></div>
        <div class="result-cta-card" id="ctaCard">
            <h3>This is just the beginning</h3>
            <p>Your Dressage Journey builds on hundreds of moments like this one â€” transforming your training experiences into patterns, insights, and a coaching conversation that grows with you.</p>
            <div id="ctaForm">
                <div class="cta-input-row">
                    <input type="email" id="ctaEmail" class="cta-email-input" placeholder="your@email.com" autocomplete="email" />
                    <button class="btn-cta" id="ctaBtn" onclick="submitWaitlist()">Get Priority Access</button>
                </div>
                <div class="cta-error" id="ctaError"></div>
                <p style="font-size: 0.78em; opacity: 0.6; margin-top: 12px;">Priority notice + an exclusive offer when we launch. No spam.</p>
            </div>
            <div id="ctaSuccess" style="display:none">
                <div class="cta-success-check">âœ“</div>
                <p class="cta-thanks">You're on the list! We'll reach out before anyone else.</p>
            </div>
        </div>
        <div class="result-restart">
            <a href="#" onclick="restartJourney(); return false;">Start over with a different horse or story</a>
        </div>
    </div>

</div><!-- /main -->

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// QUESTION DEFINITIONS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const QUESTIONS = [
    {
        id: 'rider_name',
        step: 'About You Â· 1 of 2',
        text: "What's your first name?",
        sub: null,
        type: 'text',
        placeholder: 'Your first name',
        required: true,
    },
    {
        id: 'why_dressage',
        step: 'About You Â· 2 of 2',
        text: "Tell us something we should know about why you ride dressage.",
        sub: "What draws you back to it, again and again â€” even on the hard days?",
        type: 'textarea',
        placeholder: 'There\'s something about the precision, the partnership, the pursuit of something I can never fully reach\u2026',
        required: true,
    },
    {
        id: 'horse_name',
        step: 'About Your Horse Â· 1 of 3',
        text: "What is your horse's name?",
        sub: null,
        type: 'text',
        placeholder: 'Your horse\'s name',
        required: true,
    },
    {
        id: 'horse_special',
        step: 'About Your Horse Â· 2 of 3',
        text: "What's something special about this horse that words barely do justice to?",
        sub: "A quality, a quirk, a gift â€” something that makes this horse uniquely themselves.",
        type: 'textarea',
        placeholder: 'When she\'s really with me, it feels like we share a language nobody else can hear\u2026',
        required: true,
    },
    {
        id: 'partnership',
        step: 'About Your Horse Â· 3 of 3',
        text: "What's something important to understand about your partnership with this horse right now?",
        sub: "Where you are together at this moment â€” what's working, what's still becoming.",
        type: 'textarea',
        placeholder: 'We\'re building trust around the canter work. Some days it flows, some days we\'re negotiating\u2026',
        required: true,
    },
    {
        id: 'milestone',
        step: 'Your Story Â· 1 of 6',
        catColor: '#4A7DC4',
        text: "Describe a recent moment in your riding that felt like a personal breakthrough â€” big or small.",
        sub: "Something that came from inside you. A skill that finally clicked, a fear you moved through, a moment of understanding.",
        type: 'textarea',
        placeholder: 'Last week I managed to stay soft in my hip through the entire canter transitionâ€¦',
        required: true,
    },
    {
        id: 'validation',
        step: 'Your Story Â· 2 of 6',
        catColor: '#5B9E6B',
        text: "Tell us about an achievement in your riding that you're particularly proud of.",
        sub: "Something recognized from outside â€” a score, feedback from a trainer, a show result, something someone said that landed.",
        type: 'textarea',
        placeholder: 'My trainer said she finally saw my horse stepping under himself in the trotâ€¦',
        required: true,
    },
    {
        id: 'aha',
        step: 'Your Story Â· 3 of 6',
        catColor: '#C9A227',
        text: "Describe a dressage insight you've recently (re)discovered â€” something that clicked in a new way.",
        sub: "An idea, a principle, or a feeling that suddenly made more sense than it ever had before.",
        type: 'textarea',
        placeholder: 'I finally understood what my trainer meant about "riding from back to front"â€¦',
        required: true,
    },
    {
        id: 'obstacle',
        step: 'Your Story Â· 4 of 6',
        catColor: '#C45252',
        text: "Describe a challenge you're currently facing in your riding â€” the one that keeps showing up.",
        sub: "Be honest. The patterns we struggle to name are often the ones most worth understanding.",
        type: 'textarea',
        placeholder: 'My right rein. I know I hold too much, and I know why, but I can\'t seem to break the habit\u2026',
        required: true,
    },
    {
        id: 'connection',
        step: 'Your Story Â· 5 of 6',
        catColor: '#8B5EA0',
        text: "Describe a moment when you felt a genuine connection to your horse â€” when the conversation between you was real.",
        sub: "When the language between you was clear, and you both knew it.",
        type: 'textarea',
        placeholder: 'There was one hack last autumn where I just let go and she justâ€¦ listened. We were one thing moving through the fieldâ€¦',
        required: true,
    },
    {
        id: 'body',
        step: 'Your Story Â· 6 of 6',
        catColor: '#7BA7BC',
        text: "Describe something about your position or body that you regularly work to improve â€” and why it matters to you.",
        sub: "What does your body do in the saddle that you're still learning to understand or change?",
        type: 'textarea',
        placeholder: 'My lower back tightens when I\'m nervous, which blocks the swing in my seat\u2026',
        required: true,
    },
    {
        id: 'recent_ride',
        step: 'A Recent Ride',
        text: "Think of a recent ride. Describe one thing that stuck with you â€” and why it did.",
        sub: "It could be a success, a struggle, a strange moment, or a quiet feeling you haven't shaken.",
        type: 'textarea',
        placeholder: 'The whole ride felt off until the very last halt, which was absolutely perfect. I couldn\'t stop thinking about why\u2026',
        required: true,
    },
    {
        id: 'happiness',
        step: 'Self-Awareness',
        text: "When do you feel most alive and happy when you're riding?",
        sub: "What does that feel like, and what tends to produce it?",
        type: 'textarea',
        placeholder: 'When my horse is truly in front of my leg and I feel like I could ask for anythingâ€¦',
        required: true,
    },
    {
        id: 'show_level',
        step: 'Upcoming Competition',
        isOptional: true,
        text: 'I\'m planning to show at this level soon', 
        sub: "Optional â€” skip if you're not preparing for a show right now.",
        type: 'select',
        options: [
            { value: '', label: 'Skip â€” I\'m not preparing for a show right now' },
            { value: 'Introductory', label: 'Introductory Level' },
            { value: 'Training Level', label: 'Training Level' },
            { value: 'First Level', label: 'First Level' },
            { value: 'Second Level', label: 'Second Level' },
            { value: 'Third Level', label: 'Third Level' },
            { value: 'Fourth Level', label: 'Fourth Level' },
            { value: 'Prix St. Georges', label: 'Prix St. Georges' },
            { value: 'Intermediaire I', label: 'IntermÃ©diaire I' },
            { value: 'Intermediaire II', label: 'IntermÃ©diaire II' },
            { value: 'Grand Prix', label: 'Grand Prix' },
        ],
        required: false,
    }
];

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// STATE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let currentQ = 0;
let answers = {};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// NAVIGATION
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function startJourney() {
    document.getElementById('welcomeScreen').style.display = 'none';
    showQuestion(0);
}

function showQuestion(index) {
    currentQ = index;
    const q = QUESTIONS[index];
    const total = QUESTIONS.length;
    const pct = Math.round(((index) / total) * 100);

    document.getElementById('progressLabel').textContent = `Question ${index + 1} of ${total}`;
    document.getElementById('progressFill').style.width = pct + '%';

    const container = document.getElementById('questionContainer');

    // Build step label
    let stepHTML = `<span>${q.step}</span>`;
    if (q.catColor) {
        stepHTML = `<span class="category-dot" style="background:${q.catColor}"></span><span>${q.step}</span>`;
    }

    // Build input
    let inputHTML = '';
    if (q.type === 'text') {
        inputHTML = `<input type="text" id="qInput" placeholder="${q.placeholder || ''}" value="${answers[q.id] || ''}" autocomplete="off" />`;
    } else if (q.type === 'textarea') {
        inputHTML = `<textarea id="qInput" placeholder="${q.placeholder || ''}">${answers[q.id] || ''}</textarea>`;
    } else if (q.type === 'select') {
        const opts = q.options.map(o => `<option value="${o.value}" ${answers[q.id] === o.value ? 'selected' : ''}>${o.label}</option>`).join('');
        inputHTML = `<select id="qInput">${opts}</select>`;
    }

    // Optional badge
    const optBadge = q.isOptional ? `<span class="optional-badge">Optional</span>` : '';

    // Back button
    const backBtn = index > 0 ? `<button class="btn-back" onclick="goBack()">â† Back</button>` : `<div></div>`;

    // Next button label
    const isLast = index === total - 1;
    const nextLabel = isLast ? 'Generate My Glimpse â†’' : 'Continue â†’';

    // Skip link for optional
    const skipLink = q.isOptional ? `<div class="skip-link"><a href="#" onclick="skipAndSubmit(); return false;">Skip this question</a></div>` : '';

    container.innerHTML = `
        <div class="question-screen" id="activeQuestion" style="display:block">
            <div class="question-card">
                <div class="q-step">${stepHTML}</div>
                <div class="q-text">${q.text}${optBadge}</div>
                ${q.sub ? `<div class="q-sub">${q.sub}</div>` : ''}
                ${inputHTML}
                <div class="q-nav">
                    ${backBtn}
                    <button class="btn-next" id="nextBtn" onclick="goNext()">${nextLabel}</button>
                </div>
                ${skipLink}
            </div>
        </div>
    `;

    // Focus input
    setTimeout(() => {
        const inp = document.getElementById('qInput');
        if (inp && q.type !== 'select') inp.focus();
    }, 100);

    // Scroll to top
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function getCurrentValue() {
    const inp = document.getElementById('qInput');
    return inp ? inp.value.trim() : '';
}

function goNext() {
    const q = QUESTIONS[currentQ];
    const val = getCurrentValue();

    if (q.required && !val) {
        const inp = document.getElementById('qInput');
        if (inp) {
            inp.style.borderColor = '#C45252';
            inp.style.boxShadow = '0 0 0 3px rgba(196, 82, 82, 0.1)';
            inp.focus();
            setTimeout(() => {
                inp.style.borderColor = '';
                inp.style.boxShadow = '';
            }, 2000);
        }
        return;
    }

    answers[q.id] = val;

    if (currentQ < QUESTIONS.length - 1) {
        showQuestion(currentQ + 1);
    } else {
        submitAnswers();
    }
}

function goBack() {
    // Save current value before going back
    const q = QUESTIONS[currentQ];
    const val = getCurrentValue();
    if (val) answers[q.id] = val;

    if (currentQ > 0) showQuestion(currentQ - 1);
}

function skipAndSubmit() {
    // Optional question â€” skip it and submit
    answers[QUESTIONS[currentQ].id] = '';
    submitAnswers();
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// SUBMIT & API CALL
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function submitAnswers() {
    document.getElementById('questionContainer').style.display = 'none';
    document.getElementById('progressFill').style.width = '100%';
    document.getElementById('progressLabel').textContent = 'Generating your glimpseâ€¦';

    const loadingScreen = document.getElementById('loadingScreen');
    loadingScreen.style.display = 'block';
    window.scrollTo({ top: 0, behavior: 'smooth' });

    // Rotate loading messages
    const msgs = [
        'Reading what you\'ve sharedâ€¦',
        `Thinking about ${answers.rider_name || 'your'} journeyâ€¦`,
        `Considering ${answers.horse_name || 'your horse'} and what they revealâ€¦`,
        'Finding the thread that connects it allâ€¦',
        'Almost readyâ€¦',
    ];
    let msgIndex = 0;
    const msgEl = document.getElementById('loadingMsg');
    msgEl.classList.add('visible');
    const msgInterval = setInterval(() => {
        msgIndex = (msgIndex + 1) % msgs.length;
        msgEl.classList.remove('visible');
        setTimeout(() => {
            msgEl.textContent = msgs[msgIndex];
            msgEl.classList.add('visible');
        }, 400);
    }, 2200);

    try {
        const prompt = buildPrompt(answers);
        const response = await callClaudeAPI(prompt);
        clearInterval(msgInterval);
        displayResult(response);
    } catch (err) {
        clearInterval(msgInterval);
        displayError(err.message);
    }
}

function buildPrompt(a) {
    const showLine = a.show_level
        ? `The rider is preparing to compete at ${a.show_level} level.`
        : 'The rider has not mentioned an upcoming competition.';

    return `You are an AI coach for "Your Dressage Journey," a platform that helps adult amateur dressage riders find patterns and meaning in their training.

A rider has shared the following in a brief introductory experience. Your task is to read everything carefully and provide a personalized, genuinely insightful response.

â•â•â• RIDER INFORMATION â•â•â•
Rider Name: ${a.rider_name || 'Not provided'}
Why They Ride Dressage: ${a.why_dressage || 'Not provided'}

â•â•â• HORSE INFORMATION â•â•â•
Horse Name: ${a.horse_name || 'Not provided'}
What's Special About This Horse: ${a.horse_special || 'Not provided'}
About Their Partnership: ${a.partnership || 'Not provided'}

â•â•â• REFLECTION MOMENTS â•â•â•
Personal Breakthrough (Personal Milestone): ${a.milestone || 'Not provided'}
Achievement They're Proud Of (External Validation): ${a.validation || 'Not provided'}
Insight Recently Discovered (Aha Moment): ${a.aha || 'Not provided'}
Current Challenge (Obstacle): ${a.obstacle || 'Not provided'}
Moment of Connection With Horse (Connection): ${a.connection || 'Not provided'}
Position/Body Work (Feel & Body Awareness): ${a.body || 'Not provided'}

â•â•â• RECENT RIDE â•â•â•
${a.recent_ride || 'Not provided'}

â•â•â• SELF-AWARENESS â•â•â•
When they feel most happy riding: ${a.happiness || 'Not provided'}

â•â•â• COMPETITION CONTEXT â•â•â•
${showLine}

â•â•â• YOUR TASK â•â•â•

STEP 1 â€” CHOOSE YOUR VOICE:
Read the rider's language, emotional tone, and the nature of their challenge and joy. Choose the single coaching voice that will most serve this rider right now:

- ğŸ¯ The Classical Master â€” for riders whose challenge is rooted in classical principles, training foundations, or the "why" behind technique. Wise, patient, occasionally poetic. Speaks in long arcs.
- â­ The Empathetic Coach â€” for riders whose primary story is emotional: confidence, trust with their horse, the inner experience of riding. Warm, validating, perceptive.
- ğŸ”¬ The Technical Coach â€” for riders whose obstacle is biomechanical or positional, and who describe their riding in cause-and-effect terms. Clear, specific, constructive.
- ğŸ“‹ The Strategic Planner â€” for riders who are competition-focused, goal-oriented, or preparing for something specific. Practical, forward-looking, structured.

DEFAULT to The Classical Master if the choice is unclear.

Your FIRST LINE of output must be exactly one of:
VOICE:CLASSICAL
VOICE:EMPATHETIC
VOICE:TECHNICAL
VOICE:STRATEGIC

Then continue with STEP 2 below on the next line.

STEP 2 â€” WRITE YOUR RESPONSE:

Write exactly two parts. No headers. No bullet points. No numbered lists.

PART 1 â€” ONE PARAGRAPH OF INSIGHT (5â€“8 sentences):
Begin by addressing the rider by first name. Write one substantive, personal paragraph that synthesizes what you notice across ALL their responses. Reference specific details they shared â€” their horse's name, the particular challenge or breakthrough they described, the feeling they named. Identify one meaningful pattern or connection they may not have articulated themselves. This should feel like it was written for this specific person, not anyone else. Speak in the voice you selected.

PART 2 â€” YOUR FIRST STEP:
After the paragraph, write exactly this separator: |||ACTIONABLE|||
Then write a short title (5â€“8 words) for the actionable item.
Then write: |||TEXT|||
Then write 2â€“3 sentences describing the specific actionable â€” a mental skill, a physical exercise, an intention to carry into their next ride, or a concrete goal. Make it specific enough to do. Connect it to something they actually shared.

EXAMPLE FORMAT:
[One paragraph of personal insight]
|||ACTIONABLE|||
Soften the Right Hand Before You Ask
|||TEXT|||
Before your next three rides, spend the first five minutes consciously [etc.]

Do not include the voice name in your output. Do not explain your choice. Just begin speaking in that voice.`;
}

async function callClaudeAPI(prompt) {
    // Call the Cloud Function proxy (API key stays server-side)
    const response = await fetch('/firstGlimpse', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ prompt }),
    });

    if (!response.ok) {
        const errData = await response.json().catch(() => ({}));
        throw new Error(errData.error || `Server error: ${response.status}`);
    }

    const data = await response.json();
    const text = data.text || '';
    return parseResponse(text);
}

function parseResponse(text) {
    // Extract VOICE: prefix if present (first line)
    let voice = null;
    let remaining = text;

    const voiceMatch = text.match(/^VOICE:(CLASSICAL|EMPATHETIC|TECHNICAL|STRATEGIC)\s*\n/);
    if (voiceMatch) {
        const voiceKey = voiceMatch[1].toLowerCase();
        const voiceMap = {
            classical:   { icon: 'ğŸ¯', name: 'The Classical Master',    color: '#5C4033' },
            empathetic:  { icon: 'â­', name: 'The Empathetic Coach',    color: '#C67B5C' },
            technical:   { icon: 'ğŸ”¬', name: 'The Technical Coach',     color: '#6B8E5F' },
            strategic:   { icon: 'ğŸ“‹', name: 'The Strategic Planner',   color: '#4A7DC4' },
        };
        voice = voiceMap[voiceKey] || voiceMap.classical;
        remaining = text.slice(voiceMatch[0].length);
    }

    const parts = remaining.split('|||ACTIONABLE|||');
    const insight = parts[0].trim();

    let actionTitle = '';
    let actionText = '';

    if (parts[1]) {
        const actionParts = parts[1].split('|||TEXT|||');
        actionTitle = actionParts[0].trim();
        actionText = actionParts[1] ? actionParts[1].trim() : '';
    }

    // Fall back to keyword-based detection if no VOICE: prefix
    if (!voice) {
        voice = detectVoice(text);
    }

    return { insight, actionTitle, actionText, voice };
}

function detectVoice(text) {
    const lower = text.toLowerCase();
    const training_scale = ['training scale', 'classical', 'principles', 'foundation', 'why not the first time', 'long arc', 'rhythm', 'suppleness', 'impulsion', 'collection'];
    const empathy = ["you've got this", "you have this", 'confidence', 'trust yourself', 'emotional', 'inner', 'courage', 'vulnerability'];
    const technical = ['did you feel', 'biomechan', 'position', 'seat bone', 'hip flexor', 'core', 'half-halt', 'aid timing', 'proprioceptive'];
    const strategic = ['competition', 'show', 'test', 'score', 'timeline', 'goal', 'strategy', 'plan'];

    let scores = { classical: 0, empathetic: 0, technical: 0, strategic: 0 };

    training_scale.forEach(k => { if (lower.includes(k)) scores.classical++; });
    empathy.forEach(k => { if (lower.includes(k)) scores.empathetic++; });
    technical.forEach(k => { if (lower.includes(k)) scores.technical++; });
    strategic.forEach(k => { if (lower.includes(k)) scores.strategic++; });

    const top = Object.entries(scores).sort((a,b) => b[1]-a[1])[0][0];

    const voiceMap = {
        classical:   { icon: 'ğŸ¯', name: 'The Classical Master',    color: '#5C4033' },
        empathetic:  { icon: 'â­', name: 'The Empathetic Coach',    color: '#C67B5C' },
        technical:   { icon: 'ğŸ”¬', name: 'The Technical Coach',     color: '#6B8E5F' },
        strategic:   { icon: 'ğŸ“‹', name: 'The Strategic Planner',   color: '#4A7DC4' },
    };

    return voiceMap[top] || voiceMap.classical;
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DISPLAY RESULT
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function displayResult(parsed) {
    document.getElementById('loadingScreen').style.display = 'none';

    const resultScreen = document.getElementById('resultScreen');
    resultScreen.style.display = 'block';

    // Greeting
    document.getElementById('resultGreeting').textContent =
        `${answers.rider_name ? answers.rider_name + '\'s' : 'Your'} First Glimpse`;

    // Voice badge
    const { icon, name } = parsed.voice;
    document.getElementById('voiceBadge').querySelector('.icon').textContent = icon;
    document.getElementById('voiceName').textContent = name;

    // Insight
    document.getElementById('resultInsight').textContent = parsed.insight;

    // Actionable
    document.getElementById('actionableTitle').textContent = parsed.actionTitle;
    document.getElementById('actionableText').textContent = parsed.actionText;

    window.scrollTo({ top: 0, behavior: 'smooth' });
    document.getElementById('progressLabel').textContent = 'Complete';
}

function displayError(msg) {
    document.getElementById('loadingScreen').style.display = 'none';
    const resultScreen = document.getElementById('resultScreen');
    resultScreen.style.display = 'block';

    document.getElementById('resultGreeting').textContent = 'Something went wrong';
    document.getElementById('resultInsight').textContent = '';

    const errCard = document.getElementById('errorCard');
    errCard.style.display = 'block';
    errCard.textContent = `We weren't able to generate your insight right now. ${msg ? 'Details: ' + msg : 'Please try again in a moment.'}`;

    document.getElementById('actionableTitle').textContent = '';
    document.getElementById('actionableText').textContent = '';
}

function restartJourney() {
    answers = {};
    currentQ = 0;
    document.getElementById('resultScreen').style.display = 'none';
    document.getElementById('errorCard').style.display = 'none';
    document.getElementById('questionContainer').style.display = '';
    document.getElementById('progressFill').style.width = '0%';
    document.getElementById('progressLabel').textContent = 'Welcome';
    showQuestion(0);
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

// Enter key advances
document.addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
        const inp = document.getElementById('qInput');
        if (inp && inp.tagName === 'INPUT') {
            e.preventDefault();
            goNext();
        }
        // Also allow Enter on the email capture field
        const emailInp = document.getElementById('ctaEmail');
        if (e.target === emailInp) {
            e.preventDefault();
            submitWaitlist();
        }
    }
});

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// WAITLIST EMAIL CAPTURE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function submitWaitlist() {
    const emailInput = document.getElementById('ctaEmail');
    const errorEl = document.getElementById('ctaError');
    const btn = document.getElementById('ctaBtn');
    const email = emailInput.value.trim();

    errorEl.textContent = '';

    // Basic client-side validation
    if (!email) {
        errorEl.textContent = 'Please enter your email address.';
        emailInput.focus();
        return;
    }

    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
        errorEl.textContent = 'Please enter a valid email address.';
        emailInput.focus();
        return;
    }

    // Disable button while submitting
    btn.disabled = true;
    btn.textContent = 'Savingâ€¦';

    try {
        const response = await fetch('/waitlist', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                email: email,
                name: answers.rider_name || '',
            }),
        });

        const data = await response.json();

        if (!response.ok) {
            throw new Error(data.error || 'Something went wrong');
        }

        // Show success state
        document.getElementById('ctaForm').style.display = 'none';
        const successEl = document.getElementById('ctaSuccess');
        successEl.style.display = 'block';

        if (data.alreadyExists) {
            successEl.querySelector('.cta-thanks').textContent =
                "You're already on the list â€” we'll be in touch soon!";
        }
    } catch (err) {
        errorEl.textContent = err.message;
        btn.disabled = false;
        btn.textContent = 'Get Priority Access';
    }
}
</script>
</body>
</html>
